!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=34)}({34:function(e,t,n){e.exports=n("SgYb")},SgYb:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var r,i,s,o,l,c,d,u,m,g,p,f=(o=$("#addIssueListingModal"),l=$("#addIssueListingForm"),c=$("#btnModalGo"),d=$("#viewIssueListingModal"),u=$("#generate_pdf"),m=null,g=null,p=function(e){$("#listing_room").select2({placeholder:Lang.get("script.select_room"),allowClear:!1,ajax:{url:"/".concat(Lang.getLocale(),"/issues/rooms_ajax/").concat(e),dataType:"json",delay:250,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,{results:e.items,pagination:{more:30*t.page<e.total_count}}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:0})},{init:function(){var e,t;$("#hotel").select2({placeholder:Lang.get("script.select_hotel"),width:"100%"}),$("#listing_room").select2({width:"100%"}),$("#listing_issue").select2({width:"100%"}),$("#hotel").on("select2:select",(function(e){var t=e.params.data.id;p(t)})),$("body").tooltip({selector:".tooltiped"}),r=$("#requested_issue_listing_datatable").KTDatatable({data:{type:"remote",source:{read:{url:listings_json_url+"?type=0",headers:{"X-CSRF-TOKEN":$("meta[name=csrf-token]").attr("content")},map:function(e){var t=e;return void 0!==e.data&&(t=e.data),t}}},pageSize:10,serverPaging:!0,serverFiltering:!0,serverSorting:!0},iDeferLoading:null,layout:{scroll:!1,footer:!1},sortable:!0,pagination:!0,search:{input:$("#requested_issue_listing_datatable_search_query"),key:"generalSearch"},rowGroup:{dataSrc:"room_id"},columns:[{field:"id",title:"#",width:40,type:"number",selector:!1,textAlign:"center",autoHide:!1},{field:"issue_id",title:Lang.get("script.Issue"),class:"font-bold",template:function(e){return e.issue.name}},{field:"device",title:Lang.get("script.device"),template:function(e){return e.room.device.name}},{field:"room_id",title:Lang.get("script.room_name"),template:function(e){return e.room.name}},{field:"date_requested",title:Lang.get("script.date_requested"),template:function(e){return moment(e.date_requested).format("DD.MM.YYYY HH:mm:ss")}},{field:"user_requested",title:Lang.get("script.user_requested"),template:function(e){return e.user_requested.name}},{field:"comment_requested",class:"dt_comment italic",title:Lang.get("script.comment"),sortable:!1,template:function(e){return e.comment_requested?'<div class="tooltiped" data-toggle="tooltip" data-html="true" title="'.concat(e.comment_requested,'">\n                  ').concat(e.comment_requested,"\n                </div>"):Lang.get("script.no_comment")}},{field:"priority",title:Lang.get("script.priority"),template:function(e){return'<span class="label label-xl label-light-'.concat(constants.priority_colors[e.priority],' label-pill label-inline">').concat(constants.priorities[e.priority],"</span>")}},{field:"Actions",title:Lang.get("script.Actions"),sortable:!1,width:125,overflow:"visible",autoHide:!1,template:function(e){return'\n                  <a href="javascript:;" class="btn btn-sm btn-light-primary" data-issue_id="'.concat(e.id,'">\n                      ').concat(Lang.get("script.fix_issue"),"\n                  </a>\n                ")}}],translate:TraceLocales.datatables()}),$("#requested_issue_listing_datatable_search_device").on("change",(function(){r.search($(this).val().toLowerCase(),"device")})),$("#requested_issue_listing_datatable_search_device").selectpicker(),$("#requestedDaterangepicker").daterangepicker({buttonClasses:" btn",applyClass:"btn-primary",cancelClass:"btn-secondary",timePicker:!0,timePickerIncrement:30,locale:{format:"MM/DD/YYYY"},ranges:(e={},a(e,Lang.get("script.today"),[moment(),moment()]),a(e,Lang.get("script.yesterday"),[moment().subtract(1,"days"),moment().subtract(1,"days")]),a(e,Lang.get("script.last7days"),[moment().subtract(6,"days"),moment()]),a(e,Lang.get("script.last30days"),[moment().subtract(29,"days"),moment()]),a(e,Lang.get("script.this_month"),[moment().startOf("month"),moment().endOf("month")]),a(e,Lang.get("script.last_month"),[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]),e)},(function(e,t,n){$("#kt_daterangepicker_4 .form-control").val(e.format("MM/DD/YYYY")+" / "+t.format("MM/DD/YYYY")),r.search({start:e.format("YYYY-MM-DD HH:mm:00"),end:t.format("YYYY-MM-DD HH:mm:00")},"Date"),m=e.format("MM/DD/YYYY"),g=t.format("MM/DD/YYYY")})).on("cancel.daterangepicker",(function(e,t){$(this).val(""),r.search({start:null,end:null},"Date"),m=null,g=null})),$("#clearRequestedDaterangepicker").click((function(){$("#requestedDaterangepicker").val(""),r.search({start:null,end:null},"Date"),m=null,g=null})),r.on("click","[data-issue_id]",(function(){var e=$(this);e.addClass("spinner spinner-right spinner-white pr-15"),$.ajax({url:"/issues/listings/fix",type:"POST",cache:!1,datatype:"JSON",data:{listing:$(this).data("issue_id")},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e,t,n,a){$(".current_requested_listings").html(e.total_requested),$(".current_fixed_listings").html(e.total_fixed),r.reload(),i.reload()},error:function(t){e.removeClass("spinner spinner-right spinner-white pr-15");var n="<b>"+String(t.responseJSON.message)+"</b><br>";for(var a in t.responseJSON.errors)t.responseJSON.errors.hasOwnProperty(a)&&(n+=t.responseJSON.errors[a]+"<br>");console.log(n)}})})),i=$("#fixed_issue_listing_datatable").KTDatatable({data:{type:"remote",source:{read:{url:listings_json_url+"?type=1",headers:{"X-CSRF-TOKEN":$("meta[name=csrf-token]").attr("content")},map:function(e){var t=e;return void 0!==e.data&&(t=e.data),s=t,t}}},pageSize:10,serverPaging:!0,serverFiltering:!0,serverSorting:!0},layout:{scroll:!1,footer:!1},sortable:!0,pagination:!0,search:{input:$("#fixed_issue_listing_datatable_search_query"),key:"generalSearch"},rowGroup:{dataSrc:"room_id"},columns:[{field:"id",title:"#",width:40,type:"number",selector:!1,textAlign:"center",autoHide:!1},{field:"issue_id",title:Lang.get("script.Issue"),class:"font-bold",template:function(e){return e.issue.name}},{field:"device",title:Lang.get("script.device"),template:function(e){return e.room.device.name}},{field:"room_id",title:Lang.get("script.room_name"),template:function(e){return e.room.name}},{field:"date_requested",title:Lang.get("script.date_requested"),template:function(e){return moment(e.date_requested).format("DD.MM.YYYY HH:mm:ss")}},{field:"date_fixed",title:Lang.get("script.date_fixed"),template:function(e){return moment(e.date_fixed).format("DD.MM.YYYY HH:mm:ss")}},{field:"user_requested",title:Lang.get("script.user_requested"),template:function(e){return e.user_requested.name}},{field:"email_fixed",title:Lang.get("script.email_fixed"),template:function(e){return e.email_fixed}},{field:"priority",title:Lang.get("script.priority"),template:function(e){return'<span class="label label-xl label-light-'.concat(constants.priority_colors[e.priority],' label-pill label-inline">').concat(constants.priorities[e.priority],"</span>")}},{field:"Actions",title:Lang.get("script.Actions"),sortable:!1,width:125,overflow:"visible",autoHide:!1,template:function(e){return'                    <button data-record-id="'.concat(e.id,'" class="btn btn-sm btn-clean" title="').concat(Lang.get("script.view_records"),'" data-toggle="modal" data-target="#viewIssueListingModal">\n                      <i class="flaticon2-document"></i> ').concat(Lang.get("script.details"),'\n                    </button>\n\n                    <a href="javascript:;" class="btnDeleteSingleRecord btn btn-sm btn-clean btn-icon" data-record_id="').concat(e.id,'" title="').concat(Lang.get("script.delete_issue"),'">                        <span class="svg-icon svg-icon-md">                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">                                    <rect x="0" y="0" width="24" height="24"/>                                    <path d="M6,8 L6,20.5 C6,21.3284271 6.67157288,22 7.5,22 L16.5,22 C17.3284271,22 18,21.3284271 18,20.5 L18,8 L6,8 Z" fill="#000000" fill-rule="nonzero"/>                                    <path d="M14,4.5 L14,4 C14,3.44771525 13.5522847,3 13,3 L11,3 C10.4477153,3 10,3.44771525 10,4 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z" fill="#000000" opacity="0.3"/>                                </g>                            </svg>                        </span>                    </a>                  ')}}],translate:TraceLocales.datatables()}),$("#fixed_issue_listing_datatable_search_device").on("change",(function(){i.search($(this).val().toLowerCase(),"device")})),$("#fixed_issue_listing_datatable_search_device").selectpicker(),$("#fixedDaterangepicker").daterangepicker({buttonClasses:" btn",applyClass:"btn-primary",cancelClass:"btn-secondary",timePicker:!0,timePickerIncrement:30,locale:{format:"MM/DD/YYYY h:mm A"},ranges:(t={},a(t,Lang.get("script.today"),[moment(),moment()]),a(t,Lang.get("script.yesterday"),[moment().subtract(1,"days"),moment().subtract(1,"days")]),a(t,Lang.get("script.last7days"),[moment().subtract(6,"days"),moment()]),a(t,Lang.get("script.last30days"),[moment().subtract(29,"days"),moment()]),a(t,Lang.get("script.this_month"),[moment().startOf("month"),moment().endOf("month")]),a(t,Lang.get("script.last_month"),[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]),t)},(function(e,t,n){$("#kt_daterangepicker_4 .form-control").val(e.format("MM/DD/YYYY h:mm A")+" / "+t.format("MM/DD/YYYY h:mm A")),i.search({start:e.format("YYYY-MM-DD HH:mm:00"),end:t.format("YYYY-MM-DD HH:mm:00")},"Date")})).on("cancel.daterangepicker",(function(e,t){$(this).val(""),i.search({start:null,end:null},"Date")})),$("#clearFixedDaterangepicker").click((function(){$("#fixedDaterangepicker").val(""),i.search({start:null,end:null},"Date")})),$("#fixed_issue_listing_datatable").on("click",".btnDeleteSingleRecord",(function(e){if(e.stopPropagation(),confirm(Lang.get("script.are_you_sure"))){var t=$(this);t.addClass("spinner spinner-right spinner-white pr-15"),$.ajax({url:"/issues/listings/delete/"+t.data("record_id"),type:"DELETE",cache:!1,datatype:"JSON",data:{_method:"DELETE"},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e,t,n,a){$(".current_requested_listings").html(e.total_requested),$(".current_fixed_listings").html(e.total_fixed),r.reload(),i.reload()},error:function(e){t.removeClass("spinner spinner-right spinner-white pr-15");var n="<b>"+String(e.responseJSON.message)+"</b><br>";for(var a in e.responseJSON.errors)e.responseJSON.errors.hasOwnProperty(a)&&(n+=e.responseJSON.errors[a]+"<br>");console.log(n)}})}})),c.on("click",(function(e){e.preventDefault(),KTApp.block(l,{overlayColor:"#000000",state:"danger",message:"Please wait..."}),$.ajax({type:"PATCH",url:l.attr("action"),data:l.serialize(),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e,t,n){$(".current_requested_listings").html(e.total),KTApp.unblock(l),o.modal("toggle"),r.reload(),i.reload()},error:function(e){KTApp.unblock(l);var t="";for(var t in e.responseJSON.errors)e.responseJSON.errors.hasOwnProperty(t)&&(t+=e.responseJSON.errors[t]+"<br>");var n={};n.title=String(e.responseJSON.message),n.message=t,$.notify(n,{type:"danger",mouse_over:!0,z_index:1051})}})})),o.on("hide.bs.modal",(function(e){var t=$(this);t.find("#hotel").val("").trigger("change"),t.find("#listing_room").val("").trigger("change"),t.find("#listing_issue").val("").trigger("change"),t.find("#listing_comment").val("")})),d.on("show.bs.modal",(function(e){var t=$(e.relatedTarget).data("record-id"),n=s.find((function(e){return e.id===t}));if(d.find('[data-trace-listing="requested_comment"').html(""),d.find('[data-trace-listing="fixed_comment"').html(""),d.find('[data-trace-listing="images"').html(""),d.find('[data-trace-listing="priority"').html(""),d.find('[data-trace-listing="issue"').html(n.issue.name),d.find('[data-trace-listing="room"').html(n.room.name),d.find('[data-trace-listing="hotel"').html(n.room.device.name),d.find('[data-trace-listing="requested_date"').html(n.date_requested),d.find('[data-trace-listing="requested_comment"').html(n.comment_requested),d.find('[data-trace-listing="fixed_email"').html(n.email_fixed),d.find('[data-trace-listing="fixed_date"').html(n.date_fixed),d.find('[data-trace-listing="fixed_comment"').html(n.comment_fixed),d.find('[data-trace-listing="priority"').html(constants.priorities[n.priority]),n.media.length){var a='<div class="grid grid-cols-3 gap-2">';n.media.forEach((function(e){a+='\n            <div class="">\n              <a class="d-block overlay" data-fslightbox="lightbox-basic" href="'.concat(e.original_url,'">\n                <div class="overlay-wrapper bgi-no-repeat bgi-position-center bgi-size-cover card-rounded min-h-150px"\n                    style="background-image:url(\'').concat(e.original_url,'\')">\n                </div>\n                <div class="overlay-layer card-rounded bg-dark bg-opacity-25 shadow">\n                    <i class="fa fa-eye text-white icon-xl"></i>\n                </div>\n              </a>\n            </div>\n            ')})),a+="</div>",d.find('[data-trace-listing="images"').html(a),refreshFsLightbox()}})),u.on("click",(function(){location.href="\n        /pdf/issues?\n        type=".concat(0,"&\n        start=",m,"&\n        end=").concat(g,"&\n        search=").concat($("#requested_issue_listing_datatable_search_query").val(),"&\n        device=").concat($("#requested_issue_listing_datatable_search_device").val(),"\n        ")}))}});jQuery(document).ready((function(){f.init()}))}});